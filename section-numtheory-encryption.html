<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-12-06T18:12:57-06:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Application: Encryption</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script><script>(function() {
  var cx = '015422183392601792159:vae7vvmmczm';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\def\ds{\displaystyle}
\def\d{\displaystyle}
\def\N{\mathbb N}
\def\B{\mathbf{B}}
\def\Z{\mathbb Z}
\def\Q{\mathbb Q}
\def\R{\mathbb R}
\def\C{\mathbb C}
\def\F{\mathbb F}
\def\pow{\mathcal P}
\def\inv{^{-1}}
\def\iff{\leftrightarrow}
\def\Iff{\Leftrightarrow}
\def\land{\wedge}
\def\And{\bigwedge}
\def\entry{\entry}
\def\AAnd{\d\bigwedge\mkern-18mu\bigwedge}
\def\Vee{\bigvee}
\def\VVee{\d\Vee\mkern-18mu\Vee}
\def\imp{\rightarrow}
\def\Imp{\Rightarrow}
\def\Fi{\Leftarrow}
\def\var{\mbox{var}}
\def\Th{\mbox{Th}}
\def\entry{\entry}
\def\sat{\mbox{Sat}}
\def\con{\mbox{Con}}
\def\iffmodels{\bmodels\models}
\def\dbland{\bigwedge \!\!\bigwedge}
\def\dom{\mbox{dom}}
\def\rng{\mbox{range}}
\def\isom{\cong}
\def\st{\mid}
\def\divides{\mid}
\def\and{\text{ and }}
\def\lcm{\text{lcm}}
\newcommand{\vtx}[2]{node[fill,circle,inner sep=0pt, minimum size=4pt,label=#1:#2]{}}
\newcommand{\va}[1]{\vtx{above}{#1}}
\newcommand{\vb}[1]{\vtx{below}{#1}}
\newcommand{\vr}[1]{\vtx{right}{#1}}
\newcommand{\vl}[1]{\vtx{left}{#1}}
\renewcommand{\v}{\vtx{above}{}}
\def\circleA{(-.5,0) circle (1)}
\def\circleAlabel{(-1.5,.6) node[above]{$A$}}
\def\circleB{(.5,0) circle (1)}
\def\circleBlabel{(1.5,.6) node[above]{$B$}}
\def\circleC{(0,-1) circle (1)}
\def\circleClabel{(.5,-2) node[right]{$C$}}
\def\twosetbox{(-2,-1.4) rectangle (2,1.4)}
\def\threesetbox{(-2.5,-2.4) rectangle (2.5,1.4)}
\def\ansfilename{practice-answers}
\def\shadowprops{{fill=black!50,shadow xshift=0.5ex,shadow yshift=0.5ex,path fading={circle with fuzzy edge 10 percent}}}
\newcommand{\hexbox}[3]{
\def\x{-cos{30}*\r*#1+cos{30}*#2*\r*2}
\def\y{-\r*#1-sin{30}*\r*#1}
\draw (\x,\y) +(90:\r) -- +(30:\r) -- +(-30:\r) -- +(-90:\r) -- +(-150:\r) -- +(150:\r) -- cycle;
\draw (\x,\y) node{#3};
}
\renewcommand{\bar}{\overline}
\newcommand{\card}[1]{\left| #1 \right|}
\newcommand{\twoline}[2]{\begin{pmatrix}#1 \\ #2 \end{pmatrix}}
\newcommand{\fixspacing}{\vspace{0pt plus 1filll}\mbox{}}
\usepackage{cancel} 
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href="http://www.math.wichita.edu/discrete-book" target="_blank"><img src="./images/WSULogo.png" alt="Logo image"></a><div class="title-container">
<h1 class="heading"><a href="discrete-class-notes.html"><span class="title">Math 321 Class Notes</span></a></h1>
<p class="byline">John Hammond</p>
</div>
<div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-numtheory-modularexp.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="ch_numtheory.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="ch_sequences.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-numtheory-modularexp.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="ch_numtheory.html" title="Up">Up</a><a class="next-button button toolbar-item" href="ch_sequences.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1">Colophon</a></li>
<li><a href="preface-1.html" data-scroll="preface-1">Preface</a></li>
<li><a href="acknowledgement-1.html" data-scroll="acknowledgement-1">Acknowledgements</a></li>
</ul>
</li>
<li class="link">
<a href="ch_basics.html" data-scroll="ch_basics"><span class="codenumber">1</span> <span class="title">Basic Objects and Symbols</span></a><ul>
<li><a href="section-prop-logic.html" data-scroll="section-prop-logic">Propositional Logic</a></li>
<li><a href="sec_objects_sets.html" data-scroll="sec_objects_sets">Sets</a></li>
<li><a href="sec_relationsfunctions.html" data-scroll="sec_relationsfunctions">Relations and Functions</a></li>
</ul>
</li>
<li class="link">
<a href="ch_logic.html" data-scroll="ch_logic"><span class="codenumber">2</span> <span class="title">Symbolic Logic and Proofs</span></a><ul>
<li><a href="section-logic-equivalences.html" data-scroll="section-logic-equivalences">Logical Equivalences</a></li>
<li><a href="sec_application_set_proofs.html" data-scroll="sec_application_set_proofs">Application: Set Properties and Equivalences</a></li>
<li><a href="section-logic-quantifiers.html" data-scroll="section-logic-quantifiers">Predicates and Logical Quantifiers</a></li>
<li><a href="section-logic-arguments.html" data-scroll="section-logic-arguments">Logical Arguments</a></li>
<li><a href="section-logic-proofs.html" data-scroll="section-logic-proofs">An introduction to proofs</a></li>
<li><a href="section-prop-supplementatal.html" data-scroll="section-prop-supplementatal">Chapter Review</a></li>
</ul>
</li>
<li class="link">
<a href="ch_numtheory.html" data-scroll="ch_numtheory"><span class="codenumber">3</span> <span class="title">Some Classic Number Theory</span></a><ul>
<li><a href="section-numtheory-divcong.html" data-scroll="section-numtheory-divcong">Divisibility and Congruences</a></li>
<li><a href="section-primes.html" data-scroll="section-primes">Prime Numbers</a></li>
<li><a href="section-gcd-euclid.html" data-scroll="section-gcd-euclid">GCDs and The Euclidean Algorithm</a></li>
<li><a href="section-multiplicative-inverses.html" data-scroll="section-multiplicative-inverses">Multiplicative Inverses</a></li>
<li><a href="section-numtheory-modularexp.html" data-scroll="section-numtheory-modularexp">Modular exponentiation</a></li>
<li><a href="section-numtheory-encryption.html" data-scroll="section-numtheory-encryption" class="active">Application: Encryption</a></li>
</ul>
</li>
<li class="link">
<a href="ch_sequences.html" data-scroll="ch_sequences"><span class="codenumber">4</span> <span class="title">Sequences, Recurrence, and Induction</span></a><ul>
<li><a href="section-objects-seqseries.html" data-scroll="section-objects-seqseries">Sequences and Series</a></li>
<li><a href="section-solvingrecurrences.html" data-scroll="section-solvingrecurrences">Solving Recurrence Relations</a></li>
<li><a href="sec_logic_induction.html" data-scroll="sec_logic_induction">Mathematical Induction</a></li>
</ul>
</li>
<li class="link">
<a href="ch_counting.html" data-scroll="ch_counting"><span class="codenumber">5</span> <span class="title">Counting Techniques</span></a><ul>
<li><a href="section-counting-basics.html" data-scroll="section-counting-basics">The Multiplicative and Additive Principles</a></li>
<li><a href="section-counting-combperm.html" data-scroll="section-counting-combperm">Combinations and Permutations</a></li>
<li><a href="section-counting-binomial.html" data-scroll="section-counting-binomial">The Binomial Theorem and Combinatorial Proofs</a></li>
<li><a href="section-counting-fib.html" data-scroll="section-counting-fib">A surprise connection - Counting Fibonacci numbers</a></li>
</ul>
</li>
<li class="link"><a href="ch_appendix.html" data-scroll="ch_appendix"><span class="codenumber">6</span> <span class="title">Appendices</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-numtheory-encryption"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">3.6</span> <span class="title">Application: Encryption</span>
</h2>
<section class="subsection" id="subsection-numtheory-ciphers"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">3.6.1</span> <span class="title">Basic Cipher Examples</span>
</h3>
<p id="p-708">Our convention will be to use only capital English letters, A to Z. We will identify each letter with the remainders modulo 26. We won't encrypt punctuation, either.: <figure class="table table-like" id="table-8"><figcaption><span class="type">Table</span><span class="space"> </span><span class="codenumber">3.6.1<span class="period">.</span></span><span class="space"> </span>List of Alphabet Encoding</figcaption><table>
<tr>
<td class="l m b1 r1 l0 t0 lines">A</td>
<td class="l m b1 r0 l0 t0 lines">0</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">G</td>
<td class="l m b1 r0 l0 t0 lines">6</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">M</td>
<td class="l m b1 r0 l0 t0 lines">12</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">S</td>
<td class="l m b1 r0 l0 t0 lines">18</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">Y</td>
<td class="l m b1 r0 l0 t0 lines" data-braille="last-cell">24</td>
</tr>
<tr>
<td class="l m b1 r1 l0 t0 lines">B</td>
<td class="l m b1 r0 l0 t0 lines">1</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">H</td>
<td class="l m b1 r0 l0 t0 lines">7</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">N</td>
<td class="l m b1 r0 l0 t0 lines">13</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">T</td>
<td class="l m b1 r0 l0 t0 lines">19</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">Z</td>
<td class="l m b1 r0 l0 t0 lines" data-braille="last-cell">25</td>
</tr>
<tr>
<td class="l m b1 r1 l0 t0 lines">C</td>
<td class="l m b1 r0 l0 t0 lines">2</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">I</td>
<td class="l m b1 r0 l0 t0 lines">8</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">O</td>
<td class="l m b1 r0 l0 t0 lines">14</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">U</td>
<td class="l m b1 r0 l0 t0 lines">20</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines" data-braille="last-cell"></td>
</tr>
<tr>
<td class="l m b1 r1 l0 t0 lines">D</td>
<td class="l m b1 r0 l0 t0 lines">3</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">J</td>
<td class="l m b1 r0 l0 t0 lines">9</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">P</td>
<td class="l m b1 r0 l0 t0 lines">15</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">V</td>
<td class="l m b1 r0 l0 t0 lines">21</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines" data-braille="last-cell"></td>
</tr>
<tr>
<td class="l m b1 r1 l0 t0 lines">E</td>
<td class="l m b1 r0 l0 t0 lines">4</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">K</td>
<td class="l m b1 r0 l0 t0 lines">10</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">Q</td>
<td class="l m b1 r0 l0 t0 lines">16</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">W</td>
<td class="l m b1 r0 l0 t0 lines">22</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines" data-braille="last-cell"></td>
</tr>
<tr>
<td class="l m b1 r1 l0 t0 lines">F</td>
<td class="l m b1 r0 l0 t0 lines">5</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">L</td>
<td class="l m b1 r0 l0 t0 lines">11</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">R</td>
<td class="l m b1 r0 l0 t0 lines">17</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines">X</td>
<td class="l m b1 r0 l0 t0 lines">23</td>
<td class="l m b1 r3 l0 t0 lines"></td>
<td class="l m b1 r1 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines" data-braille="last-cell"></td>
</tr>
</table></figure></p>
<article class="definition definition-like" id="definition-50"><h6 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">3.6.2</span><span class="period">.</span>
</h6>
<p id="p-709">A <dfn class="terminology">shift cipher</dfn> is one in which the letters of the alphabet have been shifted by some fixed amount.</p></article><article class="example example-like" id="example-83"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.6.3</span><span class="period">.</span>
</h6>
<p id="p-710">The classic example is the so-called <dfn class="terminology">Caesar Cipher</dfn> which shifts the alphabet to the right three letters. A becomes D, B becomes E, etc.</p>
<p id="p-711">We encrypt letter-by-letter via the function \(e(x) = x + 3 \pmod{26}\) and decrypt via \(d(x) = x-3 \pmod{26}\text{.}\)</p></article><article class="definition definition-like" id="definition-51"><h6 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">3.6.4</span><span class="period">.</span>
</h6>
<p id="p-712">An <dfn class="terminology">affine cipher</dfn> is one in which letters are transformed via a linear function, \(e(x) = ax+b \pmod{n} \) where \(a, b\in \Z\) and \(n\in \Z^+\text{.}\) If \(a =1\text{,}\) this is a shift cipher.</p></article><article class="note remark-like" id="note-20"><h6 class="heading">
<span class="type">Note</span><span class="space"> </span><span class="codenumber">3.6.5</span><span class="period">.</span>
</h6>
<p id="p-713">To be able to decrypt an affine function, we need \(\gcd(a,n)=1\) in order that \(a\) is an invertible element. We can find the inverse via the <a class="xref" data-knowl="./knowl/euclidean-algorithm.html" title="Theorem 3.3.6: The Euclidean Algorithm">Euclidean Algorithm with back-substitution 3.3.6</a>. Recall, the inverse of an invertible element is its Bézout coefficient.</p>
<a data-knowl="" class="id-ref original" data-refid="hk-answer-76" id="answer-76"><span class="type">Answer/Video</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-76"><div class="answer solution-like"><iframe id="video-75" width="600" height="337" allowfullscreen="" src="https://www.youtube-nocookie.com/embed/iVWyD0mvxwQ?&amp;modestbranding=1&amp;rel=0"></iframe></div></div></article><article class="example example-like" id="example-84"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.6.6</span><span class="period">.</span>
</h6>
<p id="p-714">The function \(f(x) = 5x + 14 \pmod{26} \) is an example of an affine cipher function.</p>
<ol class="decimal">
<li id="li-637">
<p id="p-715">Encipher the following letters:</p>
<ol class="lower-alpha">
<li id="li-638">A</li>
<li id="li-639">M</li>
</ol>
</li>
<li id="li-640"><p id="p-716">Given that \(5^{-1} \equiv 21\pmod{26}\text{,}\) find the inverse of \(f(x)=5x+14\pmod{26}\text{.}\) Please ensure your coefficients are reduced modulo \(26\text{.}\)</p></li>
<li id="li-641">Verify your inverse by confirming it deciphers the letters above.</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-77" id="answer-77"><span class="type">Answer/Video</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-77"><div class="answer solution-like"><iframe id="video-76" width="600" height="337" allowfullscreen="" src="https://www.youtube-nocookie.com/embed/dRLN1bj6mTI?&amp;modestbranding=1&amp;rel=0"></iframe></div></div>
</div></article><article class="definition definition-like" id="definition-52"><h6 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">3.6.7</span><span class="period">.</span><span class="space"> </span><span class="title">The RSA Algorithm.</span>
</h6>
<p id="p-717">RSA is an example of a public-key algorithm. Its security is based on the fact that factoring integers is a hard problem. The process is outlined below:</p>
<p id="p-718">To determine the keys:</p>
<ol class="decimal">
<li id="li-642">Choose two prime numbers \(p \and q\text{.}\) Let \(n=pq \and {m = (p-1)(q-1)}\text{.}\)</li>
<li id="li-643">Find any number \(e\) which is relatively prime to \(m\)</li>
<li id="li-644">Determine \(d\) which is the inverse of \(e\) modulo \(m\)</li>
<li id="li-645">Your public key is \((e, n)\text{.}\)</li>
<li id="li-646">Your private key is \((d, n)\text{.}\)</li>
</ol>
<p id="p-719">To encrypt/decrypt:</p>
<ol class="decimal">
<li id="li-647">Convert our message (plaintext or ciphertext) to numeric values, each letter taking up two digits: A is 00, B is 01, ... Z = 25.</li>
<li id="li-648">
<p id="p-720">Using the chosen \(n\) value, we split the message into blocks of even length according to the following scheme:</p>
<ol class="lower-alpha">
<li id="li-649">If \(2525 \lt n \lt 252525\text{,}\) then the blocks will be length 4</li>
<li id="li-650">If \(252525 \lt n \lt 25252525\text{,}\) then the blocks will be length 6</li>
<li id="li-651">If \(25252525 \lt n \lt 2525252525\text{,}\) then the blocks will be length 8</li>
<li id="li-652">and so on...</li>
</ol>
<p data-braille="continuation">if the message doesn't fit the appropropriate block size, append a number of 23's at the end. (padding the message with X's).</p>
</li>
<li id="li-653">Encryption occurs my taking each numeric message block \(M\) and computing \(M^e\pmod{n}\)</li>
<li id="li-654">Decryption occurs my taking each numeric cipher block \(C\) and computing \(C^d\pmod{n}\)</li>
</ol>
<p data-braille="continuation">This works because \((M^e)^d = M^{ed} = M^1 \pmod{n}\text{.}\) Although we haven't proven this, it's a result of Euler's Totient Theorem which you'll revisit in Number Theory.</p></article><article class="example example-like" id="example-85"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.6.8</span><span class="period">.</span>
</h6>
<p id="p-721">Let \(p = 59, q=83\text{.}\) Choose \(e=15\) Encrypt “WHATS UP” and then decrypt the result to confirm it worked. Do this by hand (with the help of a calculator).</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-78" id="answer-78"><span class="type">Answer/Video</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-78"><div class="answer solution-like"><iframe id="video-77" width="600" height="337" allowfullscreen="" src="https://www.youtube-nocookie.com/embed/xEf5vBH5x_Y?&amp;modestbranding=1&amp;rel=0"></iframe></div></div>
</div></article><section class="exercises" id="exercises-15"><h4 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber">3.6.1.1</span> <span class="title">Exercises</span>
</h4>
<article class="exercise exercise-like" id="exercise-109"><h6 class="heading"><span class="codenumber">1<span class="period">.</span></span></h6>
<p id="p-722">Decrypt the following message, which was encrypted by the standard Caesar cipher: “L FDQ DOZDBV WUXVW BRX, EUXWXV.”</p>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-76" id="solution-76"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-76"><div class="solution solution-like"><p id="p-723">“I can always trust you, Brutus.”</p></div></div></article><article class="exercise exercise-like" id="exercise-110"><h6 class="heading"><span class="codenumber">2<span class="period">.</span></span></h6>
<p id="p-724">Apply the affine shift \(e(x) = 7x + 11 \pmod{ 26 }\) to the string, “Encrypt me.”</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-solution-77" id="solution-77"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-77"><div class="solution solution-like"><p id="p-725">Removing spaces from the words and capitalizing everything: “NYZAXMOORN”. The integer values are 13, 24, 25, 0, 23, 12, 14, 14, 17, 13.</p></div></div>
</div></article><article class="exercise exercise-like" id="exercise-111"><h6 class="heading"><span class="codenumber">3<span class="period">.</span></span></h6>
<p id="p-726">Decrypt the text which was encrypted via the affine shift \(e(x) = 7x + 11 \pmod{ 26 }\text{:}\) “LJNHFRN”</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-solution-78" id="solution-78"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-78"><div class="solution solution-like"><p id="p-727">“Awesome”.</p></div></div>
</div></article></section></section><section class="subsection" id="subsection-numtheory-sage"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">3.6.2</span> <span class="title">Number Theory Using Sage</span>
</h3>
<p id="p-728">Sage has a convenient way of determining if a number is prime by asking if the number is in a set primes: <div class="sagecell-sage" id="sage-2"><script type="text/x-sage">37 in Primes()
</script></div> Try testing any number in the cell above.</p>
<p id="p-729">If you want to just want to get a prime number of some particular size (as we want with our <a href="section-numtheory-encryption.html#rsa-activity" class="internal" title="Subsection 3.6.3: The RSA Activity">RSA activity 3.6.3</a>), we ask sage for the next_prime: <div class="sagecell-sage" id="sage-3"><script type="text/x-sage">next_prime(123456)
</script></div></p>
<p id="bezout-gcd">The following Sage code allows us to find the GCD and Bézout coefficients via the xgcd command: <div class="sagecell-sage" id="sage-4"><script type="text/x-sage"># Change a and b to be any positive integers, then press Evaluate
a=2345
b = 234
l = a.xgcd(b)
pretty_print(str(l[0]) + "=" + str(a) + "*(" + str(l[1]) + ") + " + str(b) + "*(" + str(l[2]) + ")")
</script></div> The xgcd command returns a list of the form (gcd, first Bézout coefficient, second Bézout coefficient), and the code above pretty-prints this in a readable format.</p>
<p id="p-731">In order to do modular exponentiation, we use the powermod function. For example, to compute \(2019^{2019} \pmod{1000}\text{:}\) <div class="sagecell-sage" id="sage-5"><script type="text/x-sage">2019.powermod(2019,1000)
</script></div></p></section><section class="subsection" id="rsa-activity"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">3.6.3</span> <span class="title">The RSA Activity</span>
</h3>
<section class="exercises" id="exercises-16"><h4 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber">3.6.3.1</span> <span class="title">Exercises</span>
</h4>
<article class="exercise exercise-like" id="exercise-112"><h6 class="heading"><span class="codenumber">1<span class="period">.</span></span></h6>
<p id="p-732">In this activity, you will generate a public/private key-pair. You will send me the public key and keep your private key secret (but don't lose it! If you lose your private key, you won't be able to complete the assignment and will receive no credit).</p>
<ol class="lower-alpha">
<li id="li-655">Pick two prime numbers \(p \and q\) of some interesting size. Make them at least six or seven digits long (use Sage's <code class="code-inline tex2jax_ignore">next_prime</code>).</li>
<li id="li-656">Let \(m=(p-1)(q-1)\text{,}\) and pick any number \(e\) relatively prime to \(m\text{.}\)</li>
<li id="li-657">Find the multiplicative inverse, \(d\text{,}\) of \(e\) modulo \(m\text{.}\)</li>
<li id="li-658">Let \(n = pq\text{.}\)</li>
<li id="li-659">Record your numbers \((n, p, q, m, e, d)\) somewhere safe (but much of this is private! Keep it secret!).</li>
<li id="li-660">
<p id="p-733">Send me your public key on via <a class="external" href="mailto:hammond@math.wichita.edu?subject=My%20RSA%20Key" target="_blank">email (you can click this link!)</a> as:</p>
<pre class="code-block tex2jax_ignore">
                    n = 15244346903
                    e = 751 
                  </pre>
</li>
<li id="li-661"><p id="p-734">I'll send you an encrypted message which will look like: <code class="code-inline tex2jax_ignore">
                    [971896385, 3249912096L, 4079022731L, 8771096382L, 10148198704L]
                  </code></p></li>
<li id="li-662">Enter this information into the Sage cell below to decrypt it (using your \(n, d, \and c\)), change <code class="code-inline tex2jax_ignore">what_to_do</code> to “decrypt”, and then press Evaluate(Python).</li>
<li id="li-663">Send me the decrypted message to confirm you decrypted it correctly (remove the padded X's if relevant, and put appropriate spaces to make it a normal English statement. For example “KEEPITSECRETKEEPITSAFEXX” will not receive full credit.</li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-79" id="answer-79"><span class="type">Answer/Video</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-79"><div class="answer solution-like"><iframe id="video-78" width="600" height="337" allowfullscreen="" src="https://www.youtube-nocookie.com/embed/GyzmNNCsdWE?&amp;modestbranding=1&amp;rel=0"></iframe></div></div>
</div></article></section><p id="rsa-code"><div class="sagecell-sage" id="sage-6"><script type="text/x-sage">##### ENTER YOUR INFORMATION IN THE VARIABLES BELOW: ######

# If encrypting, set values for m, n, and e.
# If decrypting, set values for c, n, and d.

what_to_do = "encrypt" # Set what_to_do to either "encrypt" or "decrypt" (quotes matter)
m = "KEEP IT SECRET KEEP IT SAFE"   # A message to encrypt 
n = 15244346903    # Value of n = p*q
e = 751 # Public encryption exponent
d = 8545627279 # Private decryption exponent 
c = [971896385, 3249912096, 4079022731, 8771096382, 10148198704]   # The ciphertext as a comma separated list (formatting matters)

##### LEAVE EVERYTHING ELSE BELOW ALONE  ######
#####... unless you want to tinker with it. Please do!

import re, string, math

from itertools import zip_longest

def grouper(iterable, n, fillvalue=None):
    args = [iter(iterable)] * n
    return zip_longest(*args, fillvalue=fillvalue)

def encrypt():
    stripped_string = re.sub(r"\W|\d","", m.strip()).upper()

    int_string = ""
    for i in range(0,len(stripped_string)):
        the_int = string.ascii_uppercase.index(stripped_string[i])
        if the_int < 10:
            int_string += "0" + str(the_int)
        else:
            int_string += str(the_int)

    half_num_digits = (ceil(math.log10(n))//2)
    block_size = (half_num_digits-1)*2 if (int(half_num_digits*"25") > n) else half_num_digits*2        

    # append the string with x's to fill the block size.
    if (len(int_string) % block_size > 0):
        int_string += "23"*((block_size-(len(int_string) % block_size))//2)

    # Chunk the message into block_size chunks; a list of string representations 
    blocks = [("".join(x)) for x in grouper(int_string, block_size)]

    cipher_blocks = []
    for block in blocks:
        cipher_blocks.append(pow(int(block), e, n))

    print(cipher_blocks)

def decrypt():
    half_num_digits = (ceil(math.log10(n))//2)
    block_size = (half_num_digits-1)*2 if (int(half_num_digits*"25") > n) else half_num_digits*2        

    plain_blocks = []
    for block in c:
        plain_block = pow(int(block), d, n)
        plain_blocks.append(("0"*(block_size - len(str(plain_block))))+ str(plain_block))

    plaintext_message="".join(plain_blocks)

    message = ""
    ind = 0    
    while ind < len(plaintext_message):
        message += string.ascii_uppercase[ int(plaintext_message[ind:ind+2]) ]
        ind += 2
    print(message) 


# ... pretend python has forward-declaration
which_function = {"encrypt" : encrypt, "decrypt" : decrypt}

try:
    which_function[what_to_do]()
except KeyError:
    print("Please set the variable what_to_do to either 'encrypt' or 'decrypt'.")
except IndexError:
    print("There's a problem: I can't decrypt your message.")
    print("You probably have the value of d wrong... \\nDouble check your computations of d, n, m, etc (d needs to be positive, for example)")
</script></div></p></section><section class="subsection" id="subsection-39"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">3.6.4</span> <span class="title">Forum Posts about this section</span>
</h3>
<div xmlns:xi="http://www.w3.org/2001/XInclude" id="discourse-comments"></div>
<script xmlns:xi="http://www.w3.org/2001/XInclude" type="text/javascript">
        DiscourseEmbed = { discourseUrl: 'https://discourse.math.wichita.edu/',
        discourseEmbedUrl: location.href };

        (function() {
        var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
        d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
        })();
      </script></section></section></div></main>
</div>
</body>
</html>
